This wiki page details the REST services exposed by ID Authentication.

## 1. Auth Request
This service details Auth Request to be used by TSPs to authenticate an Individual. Below are various authentication types supported by this service - 
1. OTP
2. Demo
3. Static Pin
4. Bio - Fingerprint, IRIS and Face

### Resource URL
### `POST identity/auth`

### Resource details

Resource Details | Description
------------ | -------------
Response format | JSON
Requires Authentication | Yes

### Parameters
Name | Required | Description | Default Value | Example
-----|----------|-------------|---------------|--------
id | Y | API Id | | mosip.identity.auth
ver|Y |API version| | 1.0
idvId|Y|Individual's UIN/VID| |1234567890 
idvIdType|Y|Individual's ID Type| D| D
authType|Y|Individual Authentication Types supported| | pi
authType: personalIdentity| Y | Personal Identity Authentication Type| false| true
authType: address| Y | Address Authentication Type |false| false  
authType: fullAddress| Y  | Full Address Authentication Type | false| false
authType: bio| Y | Bio-metric Authentication Type | false|false
authType: otp| Y | OTP Authentication Type | false|false
authType: pin| Y | Pin Authentication Type |false |false
muaCode|Y|TSP User Agency code| |tspLevel1ID 
reqTime|Y|Time when Request was captured| | 2018-10-04T05:57:20.929+0000
txnID|Y|Request Transaction ID| | txn12345
reqHmac|Y|SHA of request element| | 
matchInfo|N|Match Info for pi and fad authentication types| | 
matchInfo: authType|N|Authentication type| | fad
matchInfo: matchingStrategy|N|Matching Strategy | E | P
matchInfo: matchingThreshold|N|Matching Threshold| 60 | 80   
pinInfo|N|Pin Info for pin and otp authentication types| | 
pinInfo: type|N|Static Pin or Dynamic Pin - otp| | 
pinInfo: value|N|Value of static pin or otp | | 
request| Y | ID request to be authenticated | | 
request: identity: name|N| name attribute of ID Object| | 
request: identity: dateOfBirth|N| dob attribute of ID Object| | 
request: identity: gender|N| gender attribute of ID Object| | 
request: identity: addressLine1|N| addressLine1 attribute of ID Object| |  
request: identity: fullAddress|N| fullAddress attribute of ID Object| | 
request: identity: leftEye|N| leftEye attribute of ID Object| |
request: identity: rightThumb|N| rightThumb attribute of ID Object| |

### Sample Request
```JSON
{
        "id" : "mosip.identity.auth",
	"ver" : "1.0",	
	"idvId" : "1234567890",
	"idvIdType" : "V",
	"authType" : 
		{
			"address" : false,
			"fullAddress" : true,
			"personalIdentity" : false,
			"otp" : false,
			"pin" : false,
			"bio" : false
		},
	"muaCode" : "tspLevel1ID",
	"txnID" : "txn12345",
	"reqTime" : "2018-10-17T07:22:57.086+0000",
	"reqHmac" : "<SHA of request element>",
	"key" : "<encrypted_encoded_session_key>",
	"matchInfo" : 
		[
			{ 
				"authType" : "fullAddress",
                                "language" : "fr",
				"matchingStrategy" : "P",
				"matchingThreshold" : 60
			}
		],
        "pinInfo" : 
		{
			"value" : "123456",
			"type" : "OTP"
		},
        "request" : 
	{
		//JSON request as per the id object schema defined by the country
		"identity": {
			"name": [
				{
					"language": "ar",
					"value": "ابراهيم"
				},
				{
					"language": "fr",
					"value": "Ibrahim"
				}
			],
			"addressLine1": [
				{
					"language": "ar",
					"value": "عنوان العينة سطر 1"
				},
				{
					"language": "fr",
					"value": "exemple d'adresse ligne 1"
				}
			],
			"fullAddress": [
				{
					"language": "ar",
					"value": "فاس-الدار البيضاء"
				},
				{
					"language": "fr",
					"value": "Casablanca"
				}
			],
			"leftEye": [
				{
					"value": "encoded_left_eye_image"
				}
			],
			"rightIndex": [
				{
					"value": "encoded_right_index_image"
				}
			]
		}		
	}
}

```
### Sample Response
#### Success Response :

Status Code : 200(OK)

```JSON
{
	"status" : true,
	"err": [],
	"txnID": "txn12345",
	"resTime": "2018-10-17T13:40:19.590+0000",
	"info": 
	{
            "idvIdType": "V",
	    "reqTime": "2018-10-17T07:22:57.086+0000",
	    "ver": "1.0",
	    "matchInfo":
	    [
	    	{
	        	"authType": "fullAddress",
                        "language" : "fr",
	        	"mathingStrategy": "P",
	        	"matchingThreshold": 60
	       	}
	    ],
           "usageData": "0xaf100000af100000"
	  }
}
```
#### Fail Response:

Status Code : 500(Error)

```JSON
{
	"status" : false,
	"err": [
           {
              "code": "IDA-MLC-002",
              "message": "Invalid UIN"
           }
        ],
	"txnID": "txn12345",
	"resTime": "2018-10-17T13:45:19.590Z",
}
```

## 2. OTP Request
This service enables TSP to request for an OTP for an Individual. The OTP will be send via message or email to the Individual. This OTP should then be used to authenticate an Individual using Auth service.

### Resource URL - `POST identity/otp`

### Resource details

Resource Details | Description
------------ | -------------
Response format | JSON
Requires Authentication | Yes

### Parameters
Name | Required | Description | Default Value | Example
-----|----------|-------------|---------------|--------
id|Y|API Id| |mosip.identity.otp
ver|Y|API version| | 1.0
idvId|Y|Individual's UIN or VID| |12341234
idvIdType|Y|Individual ID Type|D| V
muaCode|Y|User Agency code| |123123123 
reqTime|Y|Time when Request was captured| |2018-10-04T05:57:20.929Z
txnID|Y|Request Transaction ID| | abc123abc


### Sample Request
```JSON
{
  "id": "mosip.identity.otp",
  "ver": "1.0",
  "idvId": "1234567890",
  "idvIdType": "D",
  "muaCode": "tspLevel1ID",
  "reqTime": "2018-10-12T09:45:49.565Z",
  "txnID": "txn12345"
}

```
### Sample Response
#### Success Response:
Status Code : 200 (OK)
```JSON
{
  "status": true,
  "err" : [],
  "resTime": "2018-10-12T09:45:49.580Z",
  "txnID": "txn12345"
}
```

#### Failed Response :   
Status Code : 500 (Error)
```JSON
{
  "status": false,
  "err": [
    {
      "code": "IDA-OTA-006",
      "message": "OTP is Invalid"
    }
  ],
  "resTime": "2018-10-12T09:45:49.580+0000",
  "txnID": "txn12345"
}
```

