MOSIP as a platform will have multiple applications running and each application will have a set of configurations. The section details 
1. The key configuration files a system owner has to create before starting the platform
2. Launcher component which will read the configuration files, validate and launch the platform

# MOSIP Configuration
- MOSIP ID schema (This will be defined by a country at the time of deployment). Based on this schema an ID Object will be created in MOSIP (a JSON string)

### MOSIP ID definition
MOSIP ID definition JSON schema will define what attributes of an ID can be captured. Creating this configuration will be the first step for a system owner.

MOSIP will provide an ID API which can take a JSON as per the ID definition schema defined by the country. For example, creation of Pre-Registration API will look as below
```
//request
{
	"id" : "mosip.id.create",
	"ver" : "1.0",
	"id.schema.name" : "morocco-id-schema.json",
	"id.schema.ver" : "1.0",
	"request" : 
	{
		//JSON request as per the id schema defined by the country				
	}
}

//response
{
	"id" : "mosip.id.create",
	"ver" : "1.0",
	"id.schema.name" : "morocco-id-schema.json",
	"id.schema.ver" : "1.0",
	"response" : {
		"entity" : "http://example.com/id/read/56789"
	}
}

//READ ID
//request
GET - http://example.com/id/read/56789

//response
{
	"id" : "mosip.id.read",
	"ver" : "1.0",
	"id.schema.name" : "morocco-id-schema.json",
	"id.schema.ver" : "1.0",
	"responseCode" : "OK"
	"response" : 
	{
		//JSON response as per the id schema defined by the country				
	}
}

//UPDATE ID
//request
PATCH - http://example.com/id/update/56789

{
	"id" : "mosip.id.update",
	"ver" : "1.0",
	"id.schema.name" : "morocco-id-schema.json",
	"id.schema.ver" : "1.0",	
	"request" : 
	{
		//JSON request same as create structure
		//as per the id schema defined by the country				
	}
}

//response
{
	"id" : "mosip.id.update",
	"ver" : "1.0",
	"id.schema.name" : "morocco-id-schema.json",
	"id.schema.ver" : "1.0",
	"responseCode" : "OK",
	"responseMsg" : "successful",
	"errorMsg" : "",	
	"response" : 
	{
		//JSON response same as read response
		//as per the id schema defined by the country				
	}
}
```
MOSIP will take the JSON request, validate it against the schema provided by the country and save the JSON ID object in the database.

Each application using the ID Object will have a mapping file which needs to be mapped to the attributes of the country's ID schema JSON so that the application can extract the values from the ID Object and use it in their application.

The below JSON schema is a sample that a country can create.
```
       {
  "definitions": {},
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://mosip.io/morocco-id-schema.json",
  "type": "object",
  "title": "Morocco ID schema",
  "description": "Morocco ID schema",  
  "properties": {
    "name": {
      "$id": "#/properties/name",
      "type": "object",
      "title": "The Name Schema",
      "description": "Name description",
      "properties": {
        "firstName": {
          "$id": "#/properties/name/properties/firstName",
          "type": "string",
          "title": "First Name",
          "description": "First Name of an Individual",
          "maxLength": 15,
          "minLength": 2,
          "default": "",
          "examples": [
            "John"
          ]
        },
        "middleName": {
          "$id": "#/properties/name/properties/middleName",
          "type": "string",
          "title": "Middle Name",
          "description": "Middle Name of an Individual",
          "maxLength": 5,
          "minLength": 1,
          "default": "",
          "examples": [
            "P"
          ]
        },
        "lastName": {
          "$id": "#/properties/name/properties/last_name",
          "type": "string",
          "title": "Last Name",
          "description": "Last Name of an Individual",
          "maxLength": 15,
          "minLength": 2,
          "default": "",
          "examples": [
            "David"
          ]
        }
      }
    },
    "dob": {
      "$id": "#/properties/dob",
      "type": "string",
      "title": "The DoB",
      "description": "DoB description",
      "maxLength": 10,
      "minLength": 10,
      "default": "",
      "examples": [
        "01/14/1988"
      ],
      "pattern": "^[0-3]?[0-9]/[01][0-2]/[1-2][0-9][0-9][0-9]"
    },
    "gender": {
      "$id": "#/properties/gender",
      "type": "string",
      "title": "Gender",
      "description": "Gender description",
      "maxLength": 5,
      "minLength": 2,
      "default": "",
      "examples": [
        "MALE"
      ],
      "pattern": "^(.*)$"
    },
    "address": {
      "$id": "#/properties/address",
      "type": "object",
      "title": "The Address Schema",
      "description": "Address description",
      "required": [
        "addressLine1",
        "addressLine2",
        "addressLine3",
        "city",
        "postalCode"
      ],
      "properties": {
        "addressLine1": {
          "$id": "#/properties/address/properties/address_l1",
          "type": "string",
          "title": "The Address Line Schema",
          "description": "Address L1 description",
          "maxLength": 20,
          "minLength": 2,
          "default": ""
        },
        "addressLine2": {
          "$id": "#/properties/address/properties/address_l2",
          "type": "string",
          "title": "The Address Line Schema",
          "description": "Address L2 description",
           "maxLength": 20,
          "minLength": 2,
          "default": ""
        },
        "addressLine3": {
          "$id": "#/properties/address/properties/address_l3",
          "type": "string",
          "title": "The Address Line Schema",
          "description": "Address L3 description",
           "maxLength": 20,
          "minLength": 2,
          "default": ""
        },
        "city": {
          "$id": "#/properties/address/properties/city",
          "type": "string",
          "title": "City",
          "description": "City",
           "maxLength": 20,
          "minLength": 2,
          "default": ""
        },
        "postalCode": {
          "$id": "#/properties/address/properties/postalCode",
          "type": "string",
          "title": "PostalCode",
          "description": "PC",
           "maxLength": 20,
          "minLength": 2,
          "default": ""
        }
      }
    },
    "national_id": {
      "$id": "#/properties/national_id",
      "type": "string",
      "title": "The national_id Schema",
      "description": "National ID description",
       "maxLength": 10,
          "minLength": 2,
      "default": "",
      "pattern": "^(.*)$"
    },    
    
    "face": {
      "$id": "#/properties/face",
      "type": "object",
      "title": "Face",
      "description": "Face description",
      "properties": {
        "image": {
          "$id": "#/properties/face/properties/image",
          "type": "string",
          "title": "Face image",
          "description": "Face"
        },
        "threshold": {
          "$id": "#/properties/face/properties/threshold",
          "type": "integer",
          "title": "The Threshold Schema",
          "description": "Threshold description",
          "minimum": 2,
          "maximum": 10,
          "default": 3
        }
    }
    } ,    
    
    "fingerPrint": {
      "$id": "#/properties/fingerPrint",
      "type": "object",
      "title": "Fingerprint",
      "description": "Fingerprint description",
      "properties": {
        "image": {
          "$id": "#/properties/fingerprint/properties/image",
          "type": "string",
          "title": "Fingerprint image",
          "description": "FIngerprint image"
        },
        "threshold": {
          "$id": "#/properties/fingerprint/properties/threshold",
          "type": "integer",
          "title": "The Threshold Schema",
          "description": "Threshold description",
          "minimum": 2,
          "maximum": 10,
          "default": 3
        }
    }
    }
  }
}
```


### MOSIP platform config
MOSIP platform config is the file a system owner will create that controls which features are available and which ones are not. For example, in Pre-Registration module, a system owner may not wish to have booking feature and would like the users to just pre-register by giving demo details, then come to a registration center, take a token and wait in queue for registration.

Please refer to the MOSIP platform config XML @ https://github.com/mosip/mosip/blob/DEV/config/mosip_platform_config.xml

The below XML snippet shows a sample configuration

              <module id="Registration"
			description="This module helps registration Officers to enrol people for a digital ID">
			<component id="registration">
				<features>
					<feature id="demo_data_capture">
					</feature>
					<feature id="poa_doc_upload" />
					<feature id="poi_doc_upload" />
					<feature id="fingerprint_capture" required="no" />
					<feature id="iris_capture" required="yes" />
				</features>
			</component>
			<component id="data_sync">
				<features>
					<feature id="pre_registration_data_sync" />
					<feature id="master_data_sync" />
				</features>
			</component>
			<component id="id_object_upload">
				<features>
					<feature id="object_creator" />
					<feature id="object_uploader" />
				</features>
			</component>
		</module>

### MOSIP Config server
MOSIP will have a centralized config server where all the configuration elements will go including the above two configs. MOSIP will use spring cloud config to implement the config server. All the config files will be version controlled in git and the config server will fetch the config values from a git url. Different sets of configurations can be created based on the environment. One set for Pre-Prod and one for Prod etc. so that system administrators need not change the values on the same set of files.

Please refer to developer documentation @ https://github.com/mosip/mosip/wiki/3.1--MOSIP-Configuration-Server for usage steps

![Config Server Setup](_images/arch_diagrams/MOSIP_config_server_setup.png)

# MOSIP Launcher
MOSIP lanucher will be used by system owners to deploy the modules of MOSIP, do the environment setup and prepare the system for use. The key steps of MOSIP launcher are

1. Read the MOSIP ID definition and MOSIP platform config XML's and validate them (structural and value)
2. Deploy the artifacts (microservices and DB schemas) based on the platform config XML


